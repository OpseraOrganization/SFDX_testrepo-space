<apex:page showHeader="false" standardController="Case" extensions="BGAMobCustomWebtocase,BGATechserre,BGACSM,BGAMob_Offline_Controller" docType="html-5.0" standardStylesheets="false">
 <apex:form >
 <html lang="en" manifest="/bgadir/DirectAccess_appcache"> <!-- added newly -->
 <head>
    <meta charset="utf-8"></meta>
    <meta name="viewport" content="width = device-width, initial-scale = 1.0, maximum-scale = 1.0, user-scalable = no"></meta>
    <title> DirectAccess AOG </title>
    <meta name="description" content="DAR aero app"></meta>
    
     <!------ Below library is used. Do not remove ------->
    <script type="text/javascript" src="{!URLFOR($Resource.DirectAccess_Assets, 'js/lib/jquery-3.2.1.min.js')}"></script>     
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.DirectAccess_Assets, 'css/bootstrap.min.css')}"></link>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.DirectAccess_Assets, 'css/DAR-styles.css')}"></link>
    <script type="text/javascript" src="{!URLFOR($Resource.DirectAccess_Assets, 'js/DAR-ui-interaction-scripts.js')}"></script>
    <!-- <script type="text/javascript" src="{!URLFOR($Resource.DirectAccess_Assets, 'js/DAR-scripts.js')}"></script> -->  
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAcDk05hQ7DPSeuUOOUOAUVzvSHPSYBXxU"></script> -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBIfAm8knTqIxs6WyscHYRAGSHQp0WPQxE"></script>
    
    
    <!--<script type="text/javascript" src="{!URLFOR($Resource.BGAMob_JQueryMobile_zip, 'js/jquery-1.9.1.min.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.BGAMob_JQueryMobile_zip, 'js/jquery.mobile-1.3.1.min.js')}"></script>--> 
    <script type="text/javascript" src="{!URLFOR($Resource.BGAMob_JQueryMobile_zip, 'js/common.js')}"></script>
    <apex:variable var="pgUrl" value="{!phoneGapUrl}"/>
    <apex:includeScript value="{!URLFOR($Resource.Phonegap, pgUrl)}"/>
    <apex:includeScript value="{!URLFOR($Resource.SFHybridApp)}"/>
    <script type="text/javascript" src="{!URLFOR($Resource.jqueryCookieJS)}"></script>
    
    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-107361529-1', 'auto');
    ga('send', 'pageview');
    </script>
    
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <!-- <script type='async' src="https://www.googletagmanager.com/gtag/js?id=UA-107361529-1"></script> -->
   
    <!--[if IE]>
        <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Consolidated JS
    
     <script type="text/javascript" src="{!URLFOR($Resource.DirectAccess_Assets, 'js/DirectAccess_AOGScript.js')}"></script>
    
    Consolidated JS -->
    
    
 </head>
 <body>
    <div id="DAR-wrapper" >
        <div class="DAR-content"> 
            <!-- page related content -->           
            <div id="AOG" layout="block" > 
            <section id="DAR-aog-screen" class="container DAR-subcontent">
            
                 <figure id="mapholder" class="row DAR-map-socket">  </figure> 
                 <a id="SubtoHome" onclick="addURL(this);" href ="/bgadir/DirectAccess_Homepage" class="DAR-back-nav" >  </a> <!-- onclick="addURL(this);" -->
                <article class="row DAR-contact-block">
                    <h2 class="DAR-contact-heading"> Aircraft On Ground </h2>
                    <p class="DAR-contact-note"> Reach us for critical support on your next scheduled flight.  </p>
                    <!--  <ul class="DAR-contact-list list-unstyled">
                        <li class="DAR-phone"> <a class="DAR-contact-mode" href='tel:+1(800) 601 3099' > +1(800) 601 3099 (Option #4) </a>  </li> 
                        <li class="DAR-email"> <a class="DAR-contact-mode" href='mailto:AOG@honeywell.com' data-role="button" data-icon="plus" data-theme="c" > AOG@honeywell.com </a> </li> 
                    </ul> -->
                    
                    <ul id="other-number-lbl" class="DAR-contact-list list-unstyled" data-role="listview" data-shadow="false" data-inset="true" data-corners="false">                                                                         
                    </ul>
                    <apex:outputText id="USnumber" style="display:none" rendered="true" value="{!DA_AOG_USNo}" ></apex:outputText>
                    <apex:outputText id="INTnumber" style="display:none" rendered="true" value="{!DA_AOG_IntlNo}" ></apex:outputText> 
                    <apex:outputText id="AogEmail" style="display:none" rendered="true" value="{!DA_EmailAog}" ></apex:outputText>
                    
                    <span class="DAR-section-img DAR-ago"> </span>
                </article>
                <!-- <p id="expandForm" class="btn btn-default btn-lg"> Complete and Sendform </p> -->
                <div id="Caseform" style="display:none" class="row DAR-form-section" >
                    <p class="DAR-form-note"> Please complete the required(*) fields and click the "Submit" button to create a Case with AOG Support. You will receive an email confirmation shortly. </p>
                    <form>
                        <div class="form-group">
                            <label for="phone"> Phone <span class="Mandatory"> *</span></label>
                            <input type="tel" class="form-control input-lg" id="phone" placeholder="+Contry Code-Area Code-Number" ></input>
                        <span style="color:red" id="Phone-no"></span>
                        </div>
                        <div class="form-group">
                            <label for="email">Your Business Email Address <span class="Mandatory"> *</span>  </label>
                            <input type="email" class="form-control input-lg" id="Email" placeholder="Business Email Address"></input>
                        <span id="mail" style="color:red"></span>
                        </div>
                        <div class="form-group">
                            <label for="confirm-email"> Send Confirmation to <span class="Mandatory"> *</span> </label>
                            <input type="email" class="form-control input-lg" id="Alter" placeholder="Email Address to receive follow up"></input>
                        <span id="alter" style="color:red"></span>
                        </div>
                        <div class="form-group">
                            <label for="aircraft-serial-number"> Aircraft Serial Number <span class="Mandatory"> *</span> </label>
                            <input type="text" class="form-control input-lg" id="serial" placeholder=""></input>
                        <span id="Serial" style="color:red"></span>
                        </div>
                        <div class="form-group">
                            <label for="aircraft-tail-number"> Aircraft Tail Number <span class="Mandatory"> *</span> </label>
                            <input type="text" class="form-control input-lg" id="tail" placeholder=""></input>
                        <span id="Tail-no" style="color:red"></span>
                        </div>
                        
                        <div class="form-group">
                            <label for="aircraft-make"> Aircraft Make <span class="Mandatory"> *</span> </label>
                            <select id="make-choice" class="form-control input-lg" onchange="changeSelectedvalue()">
                                <option value="">Select a value</option>
                            </select>
                            <span id="Make" style="color:red"></span>
                        </div>
                        <div class="form-group">
                            <label for="aircraft-type"> Aircraft Type/Model <span class="Mandatory"> *</span> </label>
                            <input type="text" class="form-control input-lg" id="model" placeholder=""></input>
                        <span id="Model" style="color:red"></span>
                        </div>
                        <div class="form-group">
                            <label for="aircraft-location">Aircraft Location <span class="Mandatory"> *</span>  </label>
                            <input type="text" class="form-control input-lg" id="location" placeholder=""></input>
                        <span id="Location" style="color:red"></span>
                        </div>
                        <div class="form-group">
                            <label for="exp-date"> Next Flight Out Date/MEL Expiration Date <span class="Mandatory"> *</span> </label>
                            <input type="date" class="form-control input-lg" id="next" placeholder="YYYY-MM-DD"></input>
                        <span id="Nextval" style="color:red"></span>
                        </div>
                        <div class="form-group">
                            <label for="problem-description">Problem Description <span class="Mandatory"> *</span>  </label>
                            <input type="text" class="form-control input-lg" id="Desc" placeholder=""></input>
                        <span id="descrp" style="color:red"></span>
                        </div>
                        <div class="form-group DAR-aog-action">
                            <label class="DAR-file-lable"> Attach a File </label>
                            <label for="file-upload" class="btn btn-default btn-lg file-btn"> 
                                  CHOOSE FILE
                                 <input type="file" id="file-upload" class="hide"></input>                                
                            </label>
                            <!-- <span class="DAR-selected-file"> Selected File </span> -->
                        </div>
                        <button type="button" class="btn btn-primary btn-lg" onclick="submitform();"> SUBMIT </button>
                  </form>
                </div>
            </section>
           </div>
           <div id="locselector" style="display : none;">
           <section id="DAR-location" class="container DAR-subcontent">
                <h4 class="row text-center"> Location </h4>
                <div class="row DAR-location-form">
                     <div class="DAR-location-form-content">
                        <div id="fse-region-search-content"  class="form-group">
                            <div class="DAR-dm-container">
                                <select class="form-control input-lg" name="asm-country-choice" id="asm-country-choice"> </select>
                            </div>
                        </div>
                        <div id="fse-region-search-content" class="form-group">
                            <div ID="DAR-state-choice" class="DAR-dm-container">
                                <select id="asm-state-choice" class="form-control input-lg"> </select>
                            </div>
                        </div>
                        <div class="form-group map-action">
                        <button class="btn btn-primary btn-lg" id="Thisismylocation" type="button"> SET AS MY LOCATION </button>
                        <span class="DAR-location-resetter" id="currentlocation"></span>
                        </div>  
                      </Div>        
                    <div id="mapholder1"  class="row DAR-map-socket">
                    </div>
                </div>
                <span id="SubHome" class="DAR-back-nav"></span>
            </section>
            </div>
           <div class="DAR-registration-status" id="Aftercasecreation" style="display:none">
               <div class="DAR-registration-status-content">
                   <p class="DAR-form-note text-center" id="caseid-alertTxt" ></p>
                   <button id="cls"  type="submit" class="btn btn-primary btn-lg" > Close </button>
               </div>
           </div>          
        </div>
    </div>
    
    <div class="DAR-spinner-wrapper"> <span class="DAR-spinner"> </span> </div>
  
 
    <script type="text/javascript">
        
            $(document).ready(function() {
    
    DAR.DARSpinner.init(true);
    
    var presentLat = localStorage.getItem('latituteval-Local');
    var presentLong = localStorage.getItem('longitudeval-Local');
    var presentState = localStorage.getItem('stateval-Local');
    var presentCountry = localStorage.getItem('countryval-Local');  
    var defaultSet = localStorage.getItem('isDefault-Local');
    
    if(((presentLat != null && presentLong != null) || presentState != null || presentCountry != null) && defaultSet == null)
    {
        showPositionFurther();
        showPosition1Further();
    }
    else
    {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError, {enableHighAccuracy: true,timeout: 25000,maximumAge: 0});
        }else {
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
        navigator.geolocation.getCurrentPosition(showPosition1, showError1);
    }
        
    // Populating the picklist     
            $("#make-choice").empty().append("<option value=''>Select a value</option>").attr('selected', 'true');
            BGAMobCustomWebtocase.getMakeLists(function (result, event) {
                if (event.status) {
                    if (result.length != 0) {
                        for (var i = 0; i < result.length; i++) {
                            
                                $("#make-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                            
                        }
                        // $('#make-choice').selectmenu( "refresh", true ).selectmenu('enable');
                    }
                } else {
                    alert('Please try again after sometime');
                }
            });

    window.onload = $('#Aftercasecreation').hide(), $('#Caseform').show(), $('#locselector').hide();

    $("#asm-country-choice").append("<option value='None'>None</option>");
    
    $("#asm-country-choice").change(function() {
        DAR.DARSpinner.init(true);
        $("#asm-state-choice").html('');
        $('#DAR-state-choice').hide();
        var doc = $('#asm-country-choice option:selected').val();
        DAR.DARSpinner.init(false);
        $("#asm-state-choice").append("<option value='None'>None</option>").attr('selected', 'true');

        if (doc == "Area Covered US" || doc == "Areas Covered Canada") {
            DAR.DARSpinner.init(true);
            $('#DAR-state-choice').show();
            BGACSM.getStatevalues(doc, function(result, event) {
                if (event.status) {

                    if (result.length != 0) {
                        for (var i = 0; i < result.length; i++) {
                            $("#asm-state-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                            DAR.DARSpinner.init(true);
                        }
                        DAR.DARSpinner.init(false);
                        //$('#asm-state-choice').selectmenu("refresh", true).selectmenu('enable');

                    }
                } else {
                    //mobile.loading( "hide" );
                    $(".bga-loader").hide(); // To Hide loader                      
                    // alert('Please try again after sometime');

                }
            });

        }

    });

    $('#SubHome').click(function() {

        DAR.DARSpinner.init(true);

        $('#locselector').hide();
        $('#AOG').show();

        DAR.DARSpinner.init(false);

    });

    

    window.onload = $('#locselector').hide();

    $('#mapholder').click(function() {
        DAR.DARSpinner.init(true);
        if ($('#asm-country-choice').val() == "None")
            $('#DAR-state-choice').hide();
        
        BGACSM.getASMCountryvalues(function(result, event) {
            if (event.status) {
                if (result.length != 0) {

                    $("#asm-country-choice").append("<option value='Area Covered US'>USA</option>");
                    $("#asm-country-choice").append("<option value='Areas Covered Canada'>CANADA</option>");

                    for (var i = 0; i < result.length; i++) {
                        $("#asm-country-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                        DAR.DARSpinner.init(true);
                    }
                  DAR.DARSpinner.init(false);
                }
            } else {

            }
        });

        
        //if ($('#asm-country-choice').val() == "None")
          //  navigator.geolocation.getCurrentPosition(showPosition1, showError1);
        //else   
         
            DAR.DARSpinner.init(false);
            
        
        $('#AOG').hide();

        $("#locselector").show();
        
        
        var s = localStorage.getItem('stateval-Local');
        var c = localStorage.getItem('countryval-Local');

        if (s != null || c != null) {
         
         google.maps.event.trigger(map2, 'resize');
         map2.setZoom(3);

         }
        
        else{
        
        google.maps.event.trigger(map1, 'resize');
        map1.setZoom(10);
        
       }

    });


    $('#Thisismylocation').click(function() {
        DAR.DARSpinner.init(true);
        if ($("#asm-country-choice").val() == 'None') {
            alert('Please Select a Country');
        } else {
            DAR.DARSpinner.init(true);
            if ($('#asm-state-choice').val() == 'None' && $("#asm-country-choice").val() != 'None') {
                console.log('2');
                    var map1 = new google.maps.Map(document.getElementById('mapholder1'), {
                    zoom: 2,
                    disableDefaultUI: true
                });

                var geocoder = new google.maps.Geocoder();

                geocodeAddress(geocoder, map1);
                localStorage.setItem('countryval-Local', $('#asm-country-choice').val());
                localStorage.removeItem('stateval-Local');
                localStorage.removeItem('latituteval-Local');
                localStorage.removeItem('longitudeval-Local');

            } else if ($('#asm-state-choice').val() != 'None' && $("#asm-country-choice").val() != 'None') {
                console.log('4');
                    var map1 = new google.maps.Map(document.getElementById('mapholder1'), {
                    zoom: 4,
                    disableDefaultUI: true
                });

                var geocoder = new google.maps.Geocoder();

                geocodeAddress(geocoder, map1);
                localStorage.setItem('countryval-Local', $('#asm-country-choice').val());
                localStorage.setItem('stateval-Local', $('#asm-state-choice').val());
                localStorage.removeItem('latituteval-Local');
                localStorage.removeItem('longitudeval-Local');

            }
            localStorage.removeItem('isDefault-Local');

            $('#Cussupplist').empty();
            searchgpsresults($("#asm-country-choice").val(), $('#asm-state-choice').val());

            // new

            $('#locselector').hide();
            $('#AOG').show();


            if ($('#asm-country-choice').val() != 'None') {
                console.log('test' + $('#asm-country-choice').val());
                var map2 = new google.maps.Map(document.getElementById('mapholder'), {
                    zoom: 4,
                    disableDefaultUI: true
                });

                var geocoder = new google.maps.Geocoder();

                geocodeAddress(geocoder, map2);
            }
            DAR.DARSpinner.init(false);

        }
        DAR.DARSpinner.init(false);

    });


    $('#currentlocation').click(function() {

        DAR.DARSpinner.init(true);

        localStorage.removeItem('latituteval-Local');
        localStorage.removeItem('longitudeval-Local');
        localStorage.removeItem('stateval-Local');
        localStorage.removeItem('countryval-Local');  
        localStorage.removeItem('isDefault-Local');
    
        location.reload();

    });

});

var map2;
var map1;

function showPosition1(position) {

    DAR.DARSpinner.init(true);

    var s = localStorage.getItem('stateval-Local');
    var c = localStorage.getItem('countryval-Local');

    if (s != null || c != null) {

            map2 = new google.maps.Map(document.getElementById('mapholder1'), {
            zoom: 4,
            disableDefaultUI: true
        });

        var geocoder = new google.maps.Geocoder();

        geocodeAddress(geocoder, map2);

        searchgpsresults(c, s);

    } else {
        var lati = position.coords.latitude;

        var lngi = position.coords.longitude;

        var myLatLng = {
            lat: lati,
            lng: lngi
        };

            map1 = new google.maps.Map(document.getElementById('mapholder1'), {
            zoom: 15,
            center: myLatLng,
            disableDefaultUI: true

        });

        var icon = new google.maps.MarkerImage("/bgadir/resource/1505374497000/DirectAccess_Assets/images/svg/DirectAccess_Sprite_v2.svg", new google.maps.Size(14, 23), new google.maps.Point(233, 329));

        var marker = new google.maps.Marker({
            position: myLatLng,
            map: map1,
            title: 'Current location',
            icon: icon
        });
        DAR.DARSpinner.init(false);
    }
}

function showError1(error) {
    switch (error.code) {
        case error.PERMISSION_DENIED:
            x.innerHTML = "User denied the request for Geolocation."
            break;
        case error.POSITION_UNAVAILABLE:
            x.innerHTML = "Location information is unavailable."
            break;
        case error.TIMEOUT:
            x.innerHTML = "The request to get user location timed out."
            break;
        case error.UNKNOWN_ERROR:
            x.innerHTML = "An unknown error occurred."
            break;
    }
}

function geocodeAddress(geocoder, resultsMap) {

    var s = localStorage.getItem('stateval-Local');
    var c = localStorage.getItem('countryval-Local');

    if ($('#asm-state-choice').val() == null || $('#asm-state-choice').val() == 'None') {

        if ($('#asm-country-choice').val() != null && $('#asm-country-choice').val() != 'None')
            var address = document.getElementById('asm-country-choice').value;
        else if (s != null && s != 'None') {
            var address = s;
        } else if (c != null && c != 'None') {
            var address = c;
        }

    } else {
        var address = document.getElementById('asm-state-choice').value;
    }

    geocoder.geocode({
        'address': address
    }, function(results, status) {
        if (status === 'OK') {
            resultsMap.setCenter(results[0].geometry.location);

            var icon = new google.maps.MarkerImage("/bgadir/resource/1505374497000/DirectAccess_Assets/images/svg/DirectAccess_Sprite_v2.svg", new google.maps.Size(14, 23), new google.maps.Point(233, 329));

            var marker = new google.maps.Marker({
                map: resultsMap,
                position: results[0].geometry.location,
                icon: icon
            });

        } else {
            alert('Geocode was not successful for the following reason: ' + status);
        }
    });
}

function showPosition(position) {

    var latlon = position.coords.latitude + "," + position.coords.longitude;

    var lati = position.coords.latitude;

    var lngi = position.coords.longitude;
    
    localStorage.setItem('latituteval-Local', lati);
    localStorage.setItem('longitudeval-Local', lngi);
    localStorage.removeItem('isDefault-Local');
    localStorage.removeItem('stateval-Local');
    localStorage.removeItem('countryval-Local');
    
    var myLatLng = {
        lat: lati,
        lng: lngi
    };

    var map = new google.maps.Map(document.getElementById('mapholder'), {
        zoom: 15,
        center: myLatLng,
        disableDefaultUI: true

    });

    var icon = new google.maps.MarkerImage("/bgadir/resource/1505374497000/DirectAccess_Assets/images/svg/DirectAccess_Sprite_v2.svg", new google.maps.Size(14, 23), new google.maps.Point(233, 329));

    var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: 'Current location',
        icon: icon
    });

    var geocoder = new google.maps.Geocoder;

    geocoder.geocode({
        'location': myLatLng
    }, function(results, status) {

        if (status === 'OK') {
            if (results[0]) {

                var arrAddress = results[0].address_components;

                var itemLocality = '';
                var itemCountry = '';


                $.each(arrAddress, function(i, address_component) {

                    if (address_component.types[0] == "administrative_area_level_1") {
                        console.log("town:" + address_component.long_name);
                        itemLocality = address_component.long_name;
                    }

                    if (address_component.types[0] == "country") {
                        console.log("country:" + address_component.long_name);
                        itemCountry = address_component.long_name;
                    }

                });

                var s = localStorage.getItem('stateval-Local');
                var c = localStorage.getItem('countryval-Local');

                if (s != null || c != null) {

                    var map2 = new google.maps.Map(document.getElementById('mapholder'), {
                        zoom: 4,
                        disableDefaultUI: true
                    });

                    var geocoder = new google.maps.Geocoder();

                    geocodeAddress(geocoder, map2);

                    searchgpsresults(c, s);

                } else {

                    searchgpsresults(itemCountry, itemLocality);

                }

            } else {
                window.alert('No results found');
            }
        } else {
            window.alert('Geocoder failed due to: ' + status);
        }
    });

}


function showPositionFurther() {

    var lati = localStorage.getItem('latituteval-Local');
    var lngi = localStorage.getItem('longitudeval-Local');
    var s = localStorage.getItem('stateval-Local');
    var c = localStorage.getItem('countryval-Local');
    
    if((lati != null) && (lngi != null))
    {
        var myLatLng = {
            lat: parseFloat(lati),
            lng: parseFloat(lngi)
        };

        var map = new google.maps.Map(document.getElementById('mapholder'), {
            zoom: 15,
            center: myLatLng,
            disableDefaultUI: true

        });

        var icon = new google.maps.MarkerImage("/bgadir/resource/1505374497000/DirectAccess_Assets/images/svg/DirectAccess_Sprite_v2.svg", new google.maps.Size(14, 23), new google.maps.Point(233, 329));

        var marker = new google.maps.Marker({
            position: myLatLng,
            map: map,
            title: 'Current location',
            icon: icon
        });

        var geocoder = new google.maps.Geocoder;

        geocoder.geocode({
            'location': myLatLng
        }, function(results, status) {

            if (status === 'OK') {
                if (results[0]) {
                    var arrAddress = results[0].address_components;
                    var itemLocality = '';
                    var itemCountry = '';


                    $.each(arrAddress, function(i, address_component) {

                        if (address_component.types[0] == "administrative_area_level_1") {
                            console.log("town:" + address_component.long_name);
                            itemLocality = address_component.long_name;
                        }

                        if (address_component.types[0] == "country") {
                            console.log("country:" + address_component.long_name);
                            itemCountry = address_component.long_name;
                        }

                    });

                    var s = localStorage.getItem('stateval-Local');
                    var c = localStorage.getItem('countryval-Local');

                    if (s != null || c != null) {

                        map2 = new google.maps.Map(document.getElementById('mapholder'), {
                            zoom: 4,
                            disableDefaultUI: true
                        });

                        var geocoder = new google.maps.Geocoder();
                        geocodeAddress(geocoder, map2);
                        searchgpsresults(c, s);

                    } else {

                        searchgpsresults(itemCountry, itemLocality);

                    }

                } else {
                    window.alert('No results found');
                }
            } else {
                window.alert('Geocoder failed due to: ' + status);
            }  
    }
        
    );
    
    }
    
    else if(s != null || c != null)
    {
        map2 = new google.maps.Map(document.getElementById('mapholder'), {
                zoom: 4,
                disableDefaultUI: true
        });

        var geocoder = new google.maps.Geocoder();
        geocodeAddress(geocoder, map2);
        searchgpsresults(c, s);
    }
}

function showPosition1Further() {
    DAR.DARSpinner.init(true);
    var s = localStorage.getItem('stateval-Local');
    var c = localStorage.getItem('countryval-Local');
    var lati = localStorage.getItem('latituteval-Local');
    var lngi = localStorage.getItem('longitudeval-Local');

    if (s != null || c != null) {

            map2 = new google.maps.Map(document.getElementById('mapholder1'), {
            zoom: 4,
            disableDefaultUI: true
        });

        var geocoder = new google.maps.Geocoder();
        geocodeAddress(geocoder, map2);
        searchgpsresults(c, s);
        DAR.DARSpinner.init(false);
    } else {
        
        var myLatLng = {
            lat: parseFloat(lati),
            lng: parseFloat(lngi)
        };

            map1 = new google.maps.Map(document.getElementById('mapholder1'), {
            zoom: 15,
            center: myLatLng,
            disableDefaultUI: true

        });

        var icon = new google.maps.MarkerImage("/bgadir/resource/1505374497000/DirectAccess_Assets/images/svg/DirectAccess_Sprite_v2.svg", new google.maps.Size(14, 23), new google.maps.Point(233, 329));

        var marker = new google.maps.Marker({
            position: myLatLng,
            map: map1,
            title: 'Current location',
            icon: icon
        });
        
    }
    DAR.DARSpinner.init(false);
} 

function showError(error) {
    localStorage.setItem('stateval-Local', 'Arizona');
    localStorage.setItem('countryval-Local', 'United States');
    localStorage.setItem('isDefault-Local', 'Yes');
    console.log('arizona run');
    showPositionFurther();
    showPosition1Further();
    DAR.DARSpinner.init(false);
}

function searchgpsresults(country, state) {
    DAR.DARSpinner.init(true);
    console.log('inside');
    if (country != 'undefined' && state != 'undefined') {
        if (country == 'United States' || country == 'Area Covered US') {
            doc = 'Area Covered US';
        } else if (country == 'Canada' || country == 'Areas Covered Canada') {
            doc = 'Areas Covered Canada';
        } else {
            doc = country;
            state = '--None--';
        }


        DAR.DARSpinner.init(true);
        if( country == 'United States' || country == 'Area Covered US') {
            DAR.DARSpinner.init(true);
            console.log('inside us aog');
            $("#other-number-lbl").empty();
            var s = $('[id$="USnumber"]').text();
            var ph = s.split(' ');
            console.log('phone numb ' + ph[0]);
            $("#other-number-lbl").append("<li class='DAR-phone'> <a id='DAR-contact-mode-tele' href='tel:"+ph[0]+"' class='DAR-contact-mode' >"+s+"</a></li>");
            DAR.DARSpinner.init(true);
            var s = $('[id$="AogEmail"]').text();   
            $("#other-number-lbl").append("<li class='DAR-email'> <a id='DAR-contact-mode-mail' href='mailto:"+s+"' class='DAR-contact-mode' >"+s+"</a></li>");
            DAR.DARSpinner.init(false);

        }  
        else{
            DAR.DARSpinner.init(true);
            console.log('inside aog');
            $("#other-number-lbl").empty();
            var s = $('[id$="INTnumber"]').text();
            var ph = s.split(' ');
            console.log('phone numb ' + ph[0]);
            $("#other-number-lbl").append("<li class='DAR-phone'> <a id='DAR-contact-mode-tele' href='tel:"+ph[0]+"' class='DAR-contact-mode' >"+s+"</a></li>");
            DAR.DARSpinner.init(true);
            var s = $('[id$="AogEmail"]').text();   
            $("#other-number-lbl").append("<li class='DAR-email'> <a id='DAR-contact-mode-mail' href='mailto:"+s+"' class='DAR-contact-mode' >"+s+"</a></li>");
            DAR.DARSpinner.init(false);

        }  

    }
}

function addURL(element) {

    $(element).attr('href', function() {
        var state = $('#asm-state-choice').val();
        var country = $('#asm-country-choice').val();
        if (state != 'NONE')
            var str1 = '?state=' + state;
        if (state == 'NONE') {
            var str1 = '';
            var str2 = '?country=' + country;
        } else
            var str2 = '&country=' + country;
        if (state == null || country == 'NONE') {
            var str1 = '?state=' + getParameterByName('state');
            var str2 = '&country=' + getParameterByName('country');
        }
        var qs = str1.concat(str2);
        if ((str1 == '?state=null' && str2 == '&country=null') || (str1 == '?state=None' && str2 == '&country=None'))
            return this.href;
        else
            return this.href + qs;
    });
}

function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}  



            // On click of submit button - Validation part
            function submitform() {
                DAR.DARSpinner.init(true);
                //alert('Comes here');
                window.scrollTo(0, 0);
                var phone = $("#phone").val();
                var mail = $("#Email").val();
                var alter = $("#Alter").val();
                var ser = $("#serial").val();
                var tal = $('#tail').val();
                var mak = $('#make-choice option:selected').val();
                var modl = $('#model').val();
                var loc = $('#location').val();
                var nextval = $('#next').val();
                var descrp = $('#Desc').val();

                var file = document.getElementById('file-upload').files[0];
                //alert(file.size);
                console.log(':::::OMG::::');
                if (phone == "") {
                    DAR.DARSpinner.init(true);
                    $("#Phone-no").text("Please enter the Phone Number.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#Phone-no").text("");
                    var filter = /^[0-9-+()\sxX]+$/;
                    if (!(filter.test(phone))) {
                        DAR.DARSpinner.init(true);
                        $("#Phone-no").text("Please enter valid Phone Number.");
                        DAR.DARSpinner.init(false);
                        return false;
                    }
                    //Save in cookie - INC000005753027
                    /* document.cookie="phone=" + phone + ";"; */
                    //Save in cookie - INC000005753027
                }
                if (mail == "") {
                    DAR.DARSpinner.init(true);
                    $("#mail").text("Please enter the Business Email Address.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#mail").text("")
                    if (!isValidEmailAddress(mail)) {
                        DAR.DARSpinner.init(true);
                        $("#mail").text("Please enter valid email address");
                        DAR.DARSpinner.init(false);
                        return false;
                    }
                    //Save in cookie - INC000005753027
                    /* document.cookie="email=" + mail + ";"; */
                    //Save in cookie - INC000005753027
                }
                if (alter == "") {
                    DAR.DARSpinner.init(true);
                    $("#alter").text("Please enter the Alternative Email Address.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#alter").text("")
                    if (!isValidEmailAddress(alter)) {
                        DAR.DARSpinner.init(true);
                        $("#alter").text("Please enter valid email address");
                        DAR.DARSpinner.init(false);
                        return false;
                    }
                    //Save in cookie - INC000005753027
                    /* document.cookie="alter=" + alter + ";"; */
                    //Save in cookie - INC000005753027
                }
                if (ser == "") {
                    DAR.DARSpinner.init(true);
                    $("#Serial").text("Please enter the Aircraft Serial Number.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#Serial").text("");
                    //Save in cookie 
                    /* document.cookie="Serial=" + ser + ";"; */
                    //Save in cookie 
                }

                if (tal == "") {
                    DAR.DARSpinner.init(true);
                    $("#Tail-no").text("Please enter the Aircraft Tail Number.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#Tail-no").text("");
                    //Save in cookie 
                    /* document.cookie="Tail-no=" + tal + ";"; */
                    //Save in cookie 
                }
                if (modl == "") {
                    //DAR.DARSpinner.init(true); 
                    $("#Model").text("Please enter the Aircraft Type/Model.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#Model").text("");
                    //Save in cookie 
                    /*  document.cookie="Model=" + modl + ";"; */
                    //Save in cookie
                }
                if (loc == "") {
                    // DAR.DARSpinner.init(true); 
                    $("#Location").text("Please enter the Aircraft Location Number.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#Location").text("");
                    //Save in cookie 
                    /*  document.cookie="Location=" + loc + ";"; */
                    //Save in cookie
                }
                if (mak == "") {
                    DAR.DARSpinner.init(true);
                    $("#Make").text("Please enter the Aircraft Make.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#Make").text("");
                    //Save in cookie 
                    /*  document.cookie="Make=" + mak + ";"; */
                    //Save in cookie
                }
                if (nextval == "") {
                    DAR.DARSpinner.init(true);
                    $("#Nextval").text("Please enter the Next Flight Out Date/MEL Expiration Date.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#Nextval").text("");
                    if (isPastDate(nextval)) {
                        DAR.DARSpinner.init(true);
                        $("#Nextval").text("Next Flight Out Date/MEL Expiration Date cannot be in the past.");
                        DAR.DARSpinner.init(false);
                        return false;
                    }
                    //Save in cookie 
                    /*  document.cookie="Nextval=" + nextval + ";"; */
                    //Save in cookie     
                }
                if (descrp == "") {
                    DAR.DARSpinner.init(true);
                    $("#descrp").text("Please enter the Problem Description.");
                    DAR.DARSpinner.init(false);
                } else {
                    $("#descrp").text("");
                    //Save in cookie 
                    /*  document.cookie="descrp=" + descrp + ";"; */
                    //Save in cookie
                }
                console.log(':::::OMG1::::');
                if (phone != "" && mail != "" && alter != "" && ser != "" && tal != "" && modl != "" && mak != "" && loc != "" && nextval != "" && descrp != "") {
                    //$.mobile.loading( "show" );  
                    DAR.DARSpinner.init(true); // To Show loader      
                    uploadFile(phone, mail, alter, mak, loc, ser, tal, modl, nextval, descrp);
                    $("#make-choice").empty().append("<option value=''>Select a value</option>").attr('selected', 'true');
                    BGAMobCustomWebtocase.getMakeLists(function (result, event) {
                        if (event.status) {
                            if (result.length != 0) {
                                for (var i = 0; i < result.length; i++) {
                                    $("#make-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                                    DAR.DARSpinner.init(true);
                                }
                                DAR.DARSpinner.init(false);
                                // $('#make-choice').selectmenu( "refresh", true ).selectmenu('enable');                     
                            }
                        } else {}
                    });
                }
                console.log(':::::OMG2::::');
                // DAR.DARSpinner.init(false);

            }
            //  Upload file functionality
            var maxStringSize = 6000000; //Maximum String size is 6,000,000 characters
            var maxFileSize = 104823351; //After Base64 Encoding, this is the max file size
            var chunkSize = 950000; //Maximum Javascript Remoting message size is 1,000,000 characters
            var attachment;
            var attachmentName;
            var fileSize;
            var positionIndex;
            var doneUploading;
            var caseidval;
            var temp;
            console.log(':::::OMG3::::');
            //Method to prepare a file to be attached to the Account bound to the page by the standardController
            function uploadFile(phone, mail, alter, mak, loc, ser, tal, modl, nextval, descrp) {
                //alert('in upload form');
                DAR.DARSpinner.init(true);
                if (navigator.userAgent.indexOf("MSIE") > 9) {
                    DAR.DARSpinner.init(true);
                    var str = alter;
                    var res = str.split('@');
                    var str2 = res[0];
                    var str3 = str2.replace('.', ' ');
                    str3 = str3.toLowerCase().replace(/\b[a-z]/g, function (letter) {
                        return letter.toUpperCase();
                    });
                    //alert(str3);
                    BGAMobCustomWebtocase.insertCase(phone, mail, alter, mak, loc, ser, tal, modl, nextval, descrp, null, null, str3, function (result, event) {
                        if (event.status) {
                            DAR.DARSpinner.init(true);
                            //$.mobile.changePage("#aog-caseNo-page");
                            //$.mobile.loading( "hide" );
                            $("#bga-loader").hide();
                            var t = result.CaseNumber;
                            temp = t.substr(5, t.length);
                            $("#caseid-alertTxt").text('Thank you for your submittal. You will receive an email confirmation shortly with this Case #' + temp + ' for further correspondence on this request.');
                            $('#AOG').hide();
                            $('#Aftercasecreation').show();
                            $("#phone").val("");
                            $("#Email").val("");
                            $("#Alter").val("");
                            $("#serial").val("");
                            $('#tail').val("");
                            $('#model').val("");
                            $('#location').val("");
                            $('#next').val("");
                            $('#Desc').val("");
                            $("#attachmentFile").val("");
                            $("#make-choice").empty().append("<option value=''>Select a value</option>").attr('selected', 'true');
                            BGAMobCustomWebtocase.getMakeLists(function (result, event) {
                                if (event.status) {
                                    if (result.length != 0) {
                                        for (var i = 0; i < result.length; i++) {
                                            $("#make-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                                        }
                                        // $('#make-choice').selectmenu( "refresh", true ).selectmenu('enable');
                                    }
                                } else {}
                            });
                        }
                        DAR.DARSpinner.init(false);
                    }, {
                        buffer: true,
                        escape: true,
                        timeout: 120000
                    });
                } else {
                    var file = document.getElementById('file-upload').files[0];

                    //alert('you uploaded file size--->'+file.size);
                    DAR.DARSpinner.init(true); // To Show loader       
                    if (file != undefined) {
                        DAR.DARSpinner.init(true);
                        //alert('attachment');
                        if (file.size <= (25 * 1024 * 1024)) {

                            attachmentName = file.name;
                            var fileReader = new FileReader();
                            fileReader.onloadend = function (e) {
                                attachment = window.btoa(this.result); //Base 64 encode the file before sending it
                                //alert('attachment'+attachment);
                                positionIndex = 0;
                                fileSize = file.size;
                                fileid = file.id;
                                doneUploading = false;
                                if (file.size <= (25 * 1024 * 1024)) {
                                    var str = alter;
                                    var res = str.split('@');
                                    var str2 = res[0];
                                    var str3 = str2.replace('.', ' ');
                                    str3 = str3.toLowerCase().replace(/\b[a-z]/g, function (letter) {
                                        return letter.toUpperCase();
                                    });
                                    //alert('1@@@@@@@@');
                                    BGAMobCustomWebtocase.insertCase(phone, mail, alter, mak, loc, ser, tal, modl, nextval, descrp, attachment, attachmentName, str3, function (result, event) {
                                        if (event.status) {
                                            DAR.DARSpinner.init(true);
                                            //$.mobile.loading( "hide" );
                                            //$.mobile.changePage("#aog-caseNo-page");
                                            var t = result.CaseNumber;
                                            temp = t.substr(5, t.length);
                                            var temp1 = result.Id;
                                            $("#caseid-alertTxt").text('Thank you for your submittal. You will receive an email confirmation shortly with this Case #' + temp + ' for further correspondence on this request.');
                                            $('#AOG').hide();
                                            $('#Aftercasecreation').show();
                                            $("#phone").val("");
                                            $("#Email").val("");
                                            $("#Alter").val("");
                                            $("#serial").val("");
                                            $('#tail').val("");
                                            $('#model').val("");
                                            $('#location').val("");
                                            $('#next').val("");
                                            $('#Desc').val("");
                                            $("#attachmentFile").val("");
                                            $("#clearBtn").hide();
                                            $("#make-choice").empty().append("<option value=''>Select a value</option>").attr('selected', 'true');
                                            BGAMobCustomWebtocase.getMakeLists(function (result, event) {
                                                if (event.status) {
                                                    if (result.length != 0) {
                                                        for (var i = 0; i < result.length; i++) {
                                                            $("#make-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                                                        }
                                                        // $('#make-choice').selectmenu( "refresh", true ).selectmenu('enable');
                                                    }
                                                } else {}
                                            });
                                            if (temp1 != undefined) {
                                                caseidval = temp1;
                                                var reader = new FileReader();
                                                reader.onload = loaded;
                                                reader.readAsDataURL(file);
                                            }
                                            DAR.DARSpinner.init(false);
                                        }
                                    }, {
                                        buffer: true,
                                        escape: true,
                                        timeout: 120000
                                    });
                                }
                            }
                            fileReader.onerror = function (e) {
                                alert("There was an error reading the file.  Please try again.");
                            }
                            fileReader.onabort = function (e) {
                                alert("There was an error reading the file.  Please try again.");
                            }
                            fileReader.readAsBinaryString(file);
                        } else {
                            alert("File must be under 25 MB in size.  Your file is too large.  Please try again.");
                        }
                    } else {
                        var str = alter;
                        var res = str.split('@');
                        var str2 = res[0];
                        var str3 = str2.replace('.', ' ');
                        str3 = str3.toLowerCase().replace(/\b[a-z]/g, function (letter) {
                            return letter.toUpperCase();
                        });
                        //alert('2@@@@@@@@');
                        BGAMobCustomWebtocase.insertCase(phone, mail, alter, mak, loc, ser, tal, modl, nextval, descrp, null, null, str3, function (result, event) {
                            if (event.status) {
                                //$.mobile.loading( "hide" );
                                $("#bga-loader").hide();
                                //$.mobile.changePage("#aog-caseNo-page");
                                var t = result.CaseNumber;
                                var temp = t.substr(5, t.length);
                                $("#caseid-alertTxt").text('Thank you for your submittal. You will receive an email confirmation shortly with this Case #' + temp + ' for further correspondence on this request.');
                                $('#AOG').hide();
                                $('#Aftercasecreation').show();
                                $("#phone").val("");
                                $("#Email").val("");
                                $("#Alter").val("");
                                $("#serial").val("");
                                $('#tail').val("");
                                $('#model').val("");
                                $('#location').val("");
                                $('#next').val("");
                                $('#Desc').val("");
                                $("#attachmentFile").val("");
                                $("#clearBtn").hide();
                                $("#make-choice").empty().append("<option value=''>Select a value</option>").attr('selected', 'true');
                                BGAMobCustomWebtocase.getMakeLists(function (result, event) {
                                    if (event.status) {
                                        if (result.length != 0) {
                                            for (var i = 0; i < result.length; i++) {
                                                $("#make-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                                            }
                                            // $('#make-choice').selectmenu( "refresh", true ).selectmenu('enable');
                                        }
                                    } else {}
                                });
                            }
                        }, {
                            buffer: true,
                            escape: true,
                            timeout: 120000
                        });
                    }
                }

            }

            function loaded(evt) {
                //alert('inside loaded function');
                $("#bga-loader").show(); // To Show loader      
                var filename = document.getElementById('file-upload').files[0].name;
                //alert('Filename'+filename);
                var file = document.getElementById('file-upload').files[0];
                //alert(file.size);
                var fileContent = String(evt.target.result);
                fileContent = fileContent.substr(fileContent.indexOf(',') + 1);
                uploadContentVersion(filename, fileContent);
            }
            ///////////////////File upload////////////////////////  
            /* var forcetkClient = new forcetk.Client();
            var fileUrl = '';
            var fileUploading = false;
            var fileBody;
            var fileNameText = '';

            function uploadContentVersion(filename, filecontent) {
                //alert('inside uploadContentVersion function');
                $("#bga-loader").show(); // To Show loader      
                fileBody = filecontent;
                fileNameText = filename;
                //alert('case id val:::' + caseidval);
                //alert('fileNameText:::::::::' + fileNameText);       
                BGAMobCustomWebtocase.getAccessToken(function (result, event) {
                    $("#bga-loader").show(); // To Show loader      
                    //alert(event.status);
                    if (event.status) {
                        $("#bga-loader").show(); // To Show loader      
                        accesstoken = result;
                        // alert(accesstoken );
                        forcetkClient.setSessionToken(accesstoken);
                        //alert('calling access token '+ accesstoken);
                        forcetkClient.create('Attachment', {
                            "ParentId": caseidval,
                            "Name": fileNameText,
                            "Body": fileBody
                        }, function (data) {
                            //alert('Attachment successfully attached to case');  
                            var caseid = data.id;
                            //alert(caseid);
                            BGAMobCustomWebtocase.caseownerupdate(caseidval, function (result, event) {
                                if (event.status) {
                                    //alert('Successfully case owner updated');
                                    //$.mobile.loading( "hide" );
                                    $("#bga-loader").hide();
                                    //$.mobile.changePage("#aog-caseNo-page");
                                    $("#caseid-alertTxt").text('Thank you for your submittal. You will receive an email confirmation shortly with this Case #' + temp + ' for further correspondence on this request.');
                                    $('#AOG').hide();
                                    $('#Aftercasecreation').show();
                                }
                            });
                        }, function (error) {
                            //alert(JSON.stringify(error));
                            BGAMobCustomWebtocase.caseownerupdate(caseidval, function (result, event) {
                                if (event.status) {
                                    //alert('Successfully case owner updated');
                                    //$.mobile.loading( "hide" );
                                    $("#bga-loader").hide();
                                    $.mobile.changePage("#aog-caseNo-page");
                                    $("#caseid-alertTxt").text('Thank you for your submittal. You will receive an email confirmation shortly with this Case #' + temp + ' for further correspondence on this request.');
                                    $('#AOG').hide();
                                    $('#Aftercasecreation').show();
                                }
                            });
                        });
                    }
                });
            } */
            
            //Method to send a file to be attached to the Account bound to the page by the standardController
            //Sends parameters: Account Id, Attachment (body), Attachment Name, and the Id of the Attachment if it exists to the controller   
            function uploadAttachment(fileId, phone, mail, alter, mak, loc, ser, tal, modl, nextval, descrp) {
                var attachmentBody = "";
                if (file.size <= positionIndex + chunkSize) {
                    attachmentBody = attachment.substring(positionIndex);
                    doneUploading = true;
                } else {
                    attachmentBody = attachment.substring(positionIndex, positionIndex + chunkSize);
                }
                var str = alter;
                var res = str.split('@');
                var str2 = res[0];
                var str3 = str2.replace('.', ' ');
                str3 = str3.toLowerCase().replace(/\b[a-z]/g, function (letter) {
                    return letter.toUpperCase();
                });
                alert('3@@@@@@@@');
                BGAMobCustomWebtocase.insertCase(phone, mail, alter, mak, loc, ser, tal, modl, nextval, descrp, attachmentBody, attachmentName, str3, function (result, event) {
                    if (event.status) {
                        //$.mobile.loading( "hide" );
                        $("#bga-loader").hide();
                        //$.mobile.changePage("#aog-caseNo-page");
                        var t = result.CaseNumber;
                        var temp = t.substr(5, t.length);
                        $("#caseid-alertTxt").text('Thank you for your submittal. You will receive an email confirmation shortly with this Case #' + temp + ' for further correspondence on this request.');
                        $('#AOG').hide();
                        $('#Aftercasecreation').show();
                        $("#phone").val("");
                        $("#Email").val("");
                        $("#Alter").val("");
                        $("#serial").val("");
                        $('#tail').val("");
                        $('#model').val("");
                        $('#location').val("");
                        $('#next').val("");
                        $('#Desc').val("");
                        $("#attachmentFile").val("");
                        $("#clearBtn").hide();
                        $("#make-choice").empty().append("<option value=''>Select a value</option>").attr('selected', 'true');
                        BGAMobCustomWebtocase.getMakeLists(function (result, event) {
                            if (event.status) {
                                if (result.length != 0) {
                                    for (var i = 0; i < result.length; i++) {
                                        $("#make-choice").append("<option value='" + result[i] + "'>" + result[i] + "</option>");
                                    }
                                    // $('#make-choice').selectmenu( "refresh", true ).selectmenu('enable');
                                }
                            } else {}
                        });
                    }
                }, {
                    buffer: true,
                    escape: true,
                    timeout: 120000
                });
            }

            function isValidEmailAddress(emailAddress) {
                var pattern = new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);
                return pattern.test(emailAddress);
            };

            function parseISO8601(dateStringInRange) {
                var isoExp = /^\s*(\d{4})-(\d\d)-(\d\d)\s*$/,
                    date = new Date(NaN),
                    month,
                    parts = isoExp.exec(dateStringInRange);
                if (parts) {
                    month = +parts[2];
                    date.setFullYear(parts[1], month - 1, parts[3]);
                    if (month != date.getMonth() + 1) {
                        date.setTime(NaN);
                    }
                }
                return date;
            }

            function isPastDate(value) {
                var now = new Date;
                var target = parseISO8601($("#next").val());
                //alert('test'+( (now.getMonth()- target.getMonth())>=0 ));
                if (now.getFullYear() > target.getFullYear()) {
                    //alert('e-if-y'+now.getFullYear());
                    return true;
                } else if ((now.getFullYear() - target.getFullYear()) >= 0 && now.getMonth() > target.getMonth()) {
                    //alert('e-if-y'+now.getMonth);
                    return true;
                } else if ((now.getFullYear() - target.getFullYear()) >= 0 && (now.getMonth() - target.getMonth()) >= 0 && now.getDate() > target.getDate()) {
                    //alert('e-if-y2'+now.getDate);
                    return true;
                }
                return false;
            }
        
        
        (function(){
                //DAR;
                DAR.DARFileInfo.init();
            })();       
    </script>
   
 </body>
 </html> 
 </apex:form>
<div class="mainForm" style="background-color: #303030;
    color: #FFFFFF;
    position: fixed;
    width: 100%;
    bottom: 0;
    left: 0;
    height:auto">
              <footer class="container">
              <div class="row">
                  <div class="form-group col-sm-7" >     
                    
                      <apex:outputLink style="color:#FFFFFF;" value="{!$Label.privacyLnk}"> Privacy Statement |</apex:outputLink>
                      <apex:outputLink style="color:#FFFFFF;" value="{!$Label.optIn}"> Subscribe |</apex:outputLink> 
                      <apex:outputLink style="color:#FFFFFF;" value="{!$Label.optOut}"> Unsubscribe |</apex:outputLink>  
                      <apex:outputLink style="color:#FFFFFF;" value="{!$Label.GlobalOptout}"> Global Unsubscribe</apex:outputLink>  
                  </div>
                    <!--  <div class="col-sm-5 text-right">                 
                          <apex:outputText style="color:#FFFFFF;" value=" 2017 Honeywell International Inc"/> 
                      </div>-->
                 </div>
              </footer>
          </div>  

</apex:page>